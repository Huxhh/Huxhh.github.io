---
title: 机器学习笔记（一）贝叶斯分类器
date: 2018-10-18 09:53:16
header-img: PrpjzD1Q/bayes2.jpg
tags: Machine Learning
---

# 机器学习笔记（一）贝叶斯分类器

## 前言
虽然前一两年就陆陆续续的了解了不少机器学习相关的知识，也在Coursera上学完了Andrew Ng的课程，但知识整体比较零碎，现在上了研究生开始上机器学习这一门课，算是比较系统的学习各个机器学习算法，因此做一些记录与总结。一方面起到课后复习汇总要点的作用，另一方面也便于日后用的时候能够立马找到参考。
整体顺序将按照课程的顺序来，首先是与贝叶斯分类器相关的东西

## 贝叶斯决策论
贝叶斯决策论的基本思想可以归结为利用贝叶斯公式将已知的类条件概率密度与先验概率转换为后验概率，并依据后验概率的大小进行分类
这里有必要复习一下先验概率与后验概率
> **先验概率** 先验概率是指根据以往经验分析得到的结果，也可理解为统计概率，通常可以通过对数据中类别出现次数的统计得到类别的先验概率
> **后验概率** 后验概率是指无法通过经验分析得到，需要根据先验概率与似然函数计算得到，可理解为某件事情已经发生，则引起该事件发生的各个因素的概率即为后验概率
> **似然函数** 似然函数是统计学中的一个概念，是关于统计模型中参数的函数，具体来说，在给定输出x时，关于参数$\theta$的似然函数$L(\theta \mid x)$等于给定参数$\theta$后变量X的概率：$L(\theta \mid x) = P(X=x\mid \theta)$
可以理解为我们要找到一个关于参数$\theta$的函数来拟合已有的数据

根据以上，贝叶斯公式可以表示为：
$$posterior = {likelihood*prior \over evidence}$$
即
$$P(c\mid x) = {P(x\mid c)P(c)\over p(x)}$$
其中$P(c\mid x)$是我们希望求得的后验概率，$P(c)$是类的先验概率，$P(x\mid c)$是类条件概率，通常可以通过似然函数使用极大似然估计计算出来。$P(x)$是用于归一化的证据因子，它对所有类别均相同，即与分类无关，可以当做一个已知的量。因此估计$P(c\mid x)$的问题可以转化为利用现有数据训练估计先验概率$P(c)$与类别条件概率$P(c\mid x)$

为了衡量贝叶斯决策的分类效果，同时使用贝叶斯决策得到最好的分类效果，我们同时应定义错误率或者说条件风险。这里我们简化采用最小化分类错误率，我们可以将误判损失写为：
* 若分类正确则$\lambda = 0$
* 若分类错误则$\lambda = 1$

此时条件风险为：
$$R(c\mid x) = 1 - \lambda P(c\mid x) = 1-P(c\mid x)$$
于是可以得到最小分类错误率的最优贝叶斯分类器为：
$$h^*(x) = arg maxP(c\mid x)$$
即对每个样本x，选择能使后验概率$P(c\mid x)$最大的类别标记
根据前面，使后验概率最大可以转化为使类条件概率与先验概率的成绩最大，即：
$$h^*(x) = arg maxP(c)P(x\mid c)$$
根据大数定律，当数据所包含的独立同分布的样本数量足够多时，$P(c)$可以通过计算频率近似得到。但类条件概率$P(x\mid c)$无法通过频率计算得到，因为在现实中样本的取值可能是大于样本的数量的，即很多可能的取值在数据中没有出现，使用频率计算显然不可行。此时我们可以使用极大似然估计来对类条件概率进行估计。

## 极大似然估计
极大似然估计的思想即是使用上面所提到的释然函数的思想。首先假设所要估计的数据具有某种确定的概率分布形式，再根据数据对概率分布的参数进行估计，也便是找到一个概率分布对我们的数据进行拟合。具体地，我们想要估计$P(x\mid c)$的概率分布，我们可以将其记为$P(x\mid \theta_c)$。接下来我们可以使用似然函数对参数$\theta$进行估计。事实上，概率模型的训练过程就是参数估计的过程。
在这里，似然函数可以写为：

$$\hat{\theta}= arg maxLL(\theta_c)$$
具体如何取得最大值可以视似然函数的情况而定
总结：极大似然函数就是试图在$\theta_c$的所有可能中，中到一个能使数据出现的可能性最大的值

## 朴素贝叶斯分类器
在上面的式子中，我们需要求得$P(x\mid c)$，但这里的$P(x\mid c)$是在所有属性上的联合概率，即$x$表示的各个属性可能是有相互关联的，若要直接计算具有较大难度，而朴素贝叶斯分类器采取了条件独立性假设来避免复杂的计算，即假设各个属性之间是相互独立的。换句话说，即各个属性对于最终的分类独立地产生影响。“朴素”即指假设的**属性相互独立**这一条件，同时另外还有半朴素贝叶斯分类，此处不表。
在此基础上，我们可以得到贝叶斯分类器的表示形式：
$$h_{nb}(x) = arg maxP(c)\prod_{i = 1}^dP(x_i\mid c)$$
朴素贝叶斯分类器的训练过程可以总结为使用给定的训练集D估计先验概率$P(c)$和类别条件概率$P(x_i\mid c)$

## 拉普拉斯平滑
上面说到在计算类表条件概率$P(x\mid c)$时需要使用极大似然估计去找到一个能够较好拟合数据的关于属性的概率分布，事实上，在计算离散属性时，我们可以使用频率来近似估计类别c中某属性出现的概率，并作为类别条件概率用于计算。例如，对语文本分类问题，我们可以统计某类文本中某个词的出现次数作为其条件概率用于计算。但使用这种方法时仍然会遇到我们上面提到的问题，即如果在数据中某个属性的某个取值没有出现，那么该取值的类别条件概率就为0，这样计算下来最终得到的后验概率也为0，这样显然是不合理的，我们可以使用拉普拉斯平滑来解决这一问题。
我们使用$D_c$表示数据集D中分类为c的样本组成的集合，使用$D_{c, x_i}$表示$D_C$中第i个属性取值为$x_i$的样本组成的集合。不考虑平滑时计算公式为：
$$P(x_i\mid c) = {\left|D_{c, x_i}\right| \over \left|D_{c}\right|} $$
我们令$N_c$表示类别c的可能取值的数量，$N_i$表示属性$x_i$的可能取值的数量，采用拉普拉斯平滑修正后的式子为：
$$P(x_i\mid c) = {\left|D_{c, x_i}\right| + 1 \over \left|D_{c}\right| + N_c} $$
同时，计算先验概率的式子也变换为：
$$P(c) = {\left|D_{c}\right| + 1 \over \left|D \right| + N_c}$$
更一般地，可以使用参数$\lambda$代替简单的加1，即：
$$P(x_i\mid c) = {\left|D_{c, x_i}\right| + \lambda \over \left|D_{c}\right| + \lambda N_c} $$
同理：
$$P(c) = {\left|D_{c}\right| + \lambda \over \left|D \right| + \lambda N_c}$$
采用这种方法可以避免由于数据不充分带来的概率估计值为0的问题。事实上，拉普拉斯平滑假设了类别与属性的均匀分布，算是额外引入的先验。


